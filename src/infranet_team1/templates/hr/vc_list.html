{% extends "base.html" %}

{% block title %}íœ´ê°€ ì‹ ì²­ ëª©ë¡{% endblock %}

{% block content %}

<h1>ğŸ“‘ íœ´ê°€ ì‹ ì²­ ëª©ë¡</h1>
<p><strong>{{ current_user.name }}</strong>ë‹˜ì˜ íœ´ê°€ ì‹ ì²­ ë‚´ì—­ ë° ì—°ì°¨ í˜„í™©ì…ë‹ˆë‹¤.</p>
<hr>

<fieldset style="margin-bottom: 20px;"><legend><strong>ë‚˜ì˜ ì—°ì°¨ í˜„í™©</strong></legend><div style="padding: 10px; font-size: 1.1em;">ì‚¬ìš© ê°€ëŠ¥ ì—°ì°¨: <strong><span style="color: blue;">{{ remaining_days }}</span> / {{ total_leave_days }}</strong> ì¼ ë‚¨ìŒ</div></fieldset>
<p><a href="{{ url_for('vacation.apply_form') }}"><button type="button">â• íœ´ê°€ ì‹ ì²­í•˜ê¸°</button></a></p>

<table border="1" style="width: 100%; border-collapse: collapse;">
<thead>
    <tr style="background-color: #f2f2f2;">
        <th style="padding: 8px;">No.</th>
        <th style="padding: 8px;">ì¢…ë¥˜</th>
        <th style="padding: 8px;">ê¸°ê°„</th>
        <th style="padding: 8px;">ì‹ ì²­ ì‚¬ìœ </th>
        <th style="padding: 8px;">ì²˜ë¦¬ ì‚¬ìœ </th>
        <th style="padding: 8px;">ìƒíƒœ</th>
        <th style="padding: 8px; width: 80px;">ìˆ˜ì •</th> 
    </tr>
</thead>
<tbody>
    {% for vacation in vacations %}
    {% if vacation.status == 'ê±°ì ˆ' %}
    <tr style="color: #999; text-decoration: line-through;">
    {% else %}
    <tr>
    {% endif %}
        <td style="text-align: center; padding: 8px;">{{ total_vacations - ((current_page - 1) * page_size) - loop.index0 }}</td>
        <td style="text-align: center; padding: 8px;">{{ vacation.vacation_type }}</td>
        <td style="text-align: center; padding: 8px;">{{ vacation.start_date }} ~ {{ vacation.end_date }}</td>
        <td style="padding: 8px;">{{ vacation.reason }}</td>
        <td style="text-align: center; padding: 8px;">
            {% if vacation.status == 'ê±°ì ˆ' and vacation.rejection_reason %}
                <span style="text-decoration: none; color: red;">{{ vacation.rejection_reason }}</span>
            {% else %}
                -
            {% endif %}
        </td>
        <td style="text-align: center; padding: 8px;">
            {% if vacation.status == 'ìŠ¹ì¸' %}<strong style="color: green;">âœ… ìŠ¹ì¸</strong>
            {% elif vacation.status == 'ëŒ€ê¸°' %}<strong style="color: orange;">â³ ëŒ€ê¸°</strong>
            {% elif vacation.status == 'ê±°ì ˆ' %}<span>âŒ ê±°ì ˆ</span>
            {% else %}{{ vacation.status }}{% endif %}
        </td>
        <td style="text-align: center; padding: 8px;">
            {% if vacation.status == 'ëŒ€ê¸°' %}
                <a href="{{ url_for('vacation.edit_form', vacation_id=vacation._id) }}" title="ìˆ˜ì •í•˜ê¸°" style="font-size: 1.2em; text-decoration: none; margin-right: 10px;">âœï¸</a>
                <form action="{{ url_for('vacation.delete_vacation', vacation_id=vacation._id) }}" method="post" style="display:inline;"><button type="submit" title="ì‚­ì œí•˜ê¸°" onclick="return confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?');" style="background:none; border:none; padding:0; cursor:pointer; font-size: 1.2em;">ğŸ—‘ï¸</button></form>
            {% else %}
                -
            {% endif %}
        </td>
    </tr>
    {% else %}
    <tr><td colspan="7" style="text-align: center; padding: 20px;">í‘œì‹œí•  íœ´ê°€ ì‹ ì²­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>
    {% endfor %}
</tbody>
</table>

<div class="pagination" style="text-align: center; margin-top: 20px;">{% if total_pages > 0 %}{% if current_page > 1 %}<a href="{{ url_for('vacation.show_list', page=current_page - 1) }}" style="text-decoration: none; padding: 5px;">Â« ì´ì „</a>{% else %}<span style="color: grey; padding: 5px;">Â« ì´ì „</span>{% endif %}{% for page_num in range(1, total_pages + 1) %}{% if page_num == current_page %}<strong style="padding: 5px; color: black;">{{ page_num }}</strong>{% else %}<a href="{{ url_for('vacation.show_list', page=page_num) }}" style="text-decoration: none; padding: 5px;">{{ page_num }}</a>{% endif %}{% endfor %}{% if current_page < total_pages %}<a href="{{ url_for('vacation.show_list', page=current_page + 1) }}" style="text-decoration: none; padding: 5px;">ë‹¤ìŒ Â»</a>{% else %}<span style="color: grey; padding: 5px;">ë‹¤ìŒ Â»</span>{% endif %}{% endif %}</div>
{% endblock %}