{% extends "base.html" %}

{% block title %}ì§ì› ëª©ë¡ (ê´€ë¦¬ì){% endblock %}

{% block content %}
<h1>ğŸ‘¥ ì§ì› ëª©ë¡ (ê´€ë¦¬ììš©)</h1>

<p>
    <a href="{{ url_for('emp_admin.employee_create_form') }}">â• ì‹ ê·œ ì§ì› ë“±ë¡</a>
</p>

<table border="1" cellpadding="5" cellspacing="0" style="width:100%; border-collapse: collapse;">
    <thead>
        <tr style="background-color: #f2f2f2;">
            <th>No.</th>
            <th>ì´ë¦„</th>
            <th>ë¶€ì„œ</th>
            <th>ì§ìœ„</th>
            <th>ì´ë©”ì¼</th>
            <th>ì…ì‚¬ì¼</th>
            <th>ìƒíƒœ</th>
            <th>ê´€ë¦¬</th>
        </tr>
    </thead>
    <tbody>
        {% if employees %}
            {% for employee in employees %}
            <tr>
                <td>{{ loop.index }}</td>
                <td>{{ employee.name }}</td>
                <td>{{ employee.department }}</td>
                <td>{{ employee.position }}</td>
                <td>{{ employee.email }}</td>
                <td>{{ employee.hire_date.strftime('%Y-%m-%d') if employee.hire_date else '-' }}</td>
                <td>{{ employee.status }}</td>
                <td>
                    <a href="{{ url_for('emp_admin.employee_edit_form', employee_id=employee._id) }}">ìƒì„¸/ìˆ˜ì •</a>
                    
                    {% if employee.status in ['ì¬ì§ì¤‘', 'íœ´ì§'] %}
                    |
                    <form action="{{ url_for('emp_admin.employee_deactivate', employee_id=employee._id) }}" method="post" style="display: inline;">
                        <input type="submit" value="ë¹„í™œì„±í™”" 
                            onclick="return confirm('ì •ë§ ì´ ì§ì›ì„ ë¹„í™œì„±í™”(í‡´ì‚¬ ì²˜ë¦¬)í•˜ì‹œê² ìŠµë‹ˆê¹Œ?');"
                            style="background: none; border: none; padding: 0; cursor: pointer; color: red; text-decoration: underline;">
                    </form>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td colspan="8" style="text-align: center; padding: 20px;">
                    {% if search_keyword or search_status or start_date or end_date %}
                        ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.
                    {% else %}
                        ë“±ë¡ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.
                    {% endif %}
                </td>
            </tr>
        {% endif %}
    </tbody>
</table>

<!-- í•˜ë‹¨ ê²€ìƒ‰ í¼ -->
<div style="margin-top: 20px; padding: 15px; border: 1px solid #ccc; background-color:#f9f9f9; text-align: center;">
    <form method="GET" action="{{ url_for('emp_admin.employee_list') }}" style="display: inline-block;">
        <select name="search_category">
            <option value="name" {% if search_category == 'name' %}selected{% endif %}>ì´ë¦„</option>
            <option value="department" {% if search_category == 'department' %}selected{% endif %}>ë¶€ì„œ</option>
            <option value="position" {% if search_category == 'position' %}selected{% endif %}>ì§ìœ„</option>
        </select>
        <input type="text" name="search_keyword" placeholder="ê²€ìƒ‰ì–´" value="{{ search_keyword or '' }}" size="15">

        <label for="status">ìƒíƒœ:</label>
        <select name="status" id="status">
            <option value="">ì „ì²´</option>
            <option value="ì¬ì§ì¤‘" {% if search_status == 'ì¬ì§ì¤‘' %}selected{% endif %}>ì¬ì§ì¤‘</option>
            <option value="í‡´ì‚¬" {% if search_status == 'í‡´ì‚¬' %}selected{% endif %}>í‡´ì‚¬</option>
            <option value="íœ´ì§" {% if search_status == 'íœ´ì§' %}selected{% endif %}>íœ´ì§</option>
        </select>

        <label for="start_date">ì…ì‚¬ì¼:</label>
        <input type="date" id="start_date" name="start_date" value="{{ start_date or '' }}">
        ~
        <input type="date" id="end_date" name="end_date" value="{{ end_date or '' }}">

        <button type="submit">ğŸ” ê²€ìƒ‰</button>
        <a href="{{ url_for('emp_admin.employee_list') }}"><button type="button">ğŸ”„ ì´ˆê¸°í™”</button></a>
    </form>
</div>

{% endblock %}