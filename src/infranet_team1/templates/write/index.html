{% extends "base.html" %}

{% block title %}ê²Œì‹œê¸€ ëª©ë¡ - ì»¤ë®¤ë‹ˆí‹°{% endblock %}

{% block content %}
<div class="container" style="display: flex;">
    <!-- ì™¼ìª½ ì‚¬ì´ë“œë°”: ì¹´í…Œê³ ë¦¬ -->
    <aside class="sidebar">
        <h3>ì¹´í…Œê³ ë¦¬</h3>
        <ul class="category-list">
            <li><a href="{{ url_for('write.home') }}">ì „ì²´ë³´ê¸°</a></li>
            <li><a href="{{ url_for('write.free_board') }}">ììœ ê²Œì‹œíŒ</a></li>
            <li><a href="{{ url_for('write.qna_board') }}">ì§ˆë¬¸ê³¼ ë‹µë³€</a></li>
            <li><a href="{{ url_for('write.notice_board') }}">ê³µì§€ì‚¬í•­</a></li>
        </ul>
    </aside>

    <!-- ì˜¤ë¥¸ìª½ ë©”ì¸ ì½˜í…ì¸  -->
    <main class="content" style="flex: 1; padding: 10px;">
        <h2>ê²Œì‹œê¸€ ëª©ë¡</h2>

        <form method="GET" action="{{ url_for('write.home') }}">
            <input type="text" name="q" placeholder="ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”" value="{{ request.args.get('q', '') }}">
            <button type="submit">ê²€ìƒ‰</button>
            <!-- ì¹´í…Œê³ ë¦¬ ìœ ì§€í•˜ë ¤ë©´ íˆë“  í•„ë“œ ì¶”ê°€ -->
            {% if request.args.get('category') %}
            <input type="hidden" name="category" value="{{ request.args.get('category') }}">
            {% endif %}
        </form>

        {% if posts %}
        <ul class="post-list">
            {% for post in posts %}
            <li>
                <a href="{{ url_for('write.detail', post_id=post._id) }}">{{ post.title }}</a>
                <small>by {{ author_map[post.author_id] }} | {{ post.created_at.strftime('%Y-%m-%d %H:%M') }}</small>
            </li>
            {% endfor %}
        </ul>

        <!-- ê²Œì‹œê¸€ ëª©ë¡ í•˜ë‹¨ì— ìƒˆê¸€ ì‘ì„± ë²„íŠ¼ ì¶”ê°€ -->
        <div style="margin-top: 20px;">
            <a href="{{ url_for('write.write_form') }}" class="btn btn-primary">ìƒˆê¸€ ì‘ì„±í•˜ê¸°</a>
        </div>

        {% else %}
        <p>ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</p>
        {% endif %}
    </main>
    <!-- í†µê³„ íŒ¨ë„ -->
    <section class="statistics" style="flex: 1; padding: 10px; background-color: #f9f9f9; border-left: 1px solid #ccc;">
        <h3>ğŸ“Š í™œë™ ìˆœìœ„</h3>
        <ul>
            {% for user_name, count in top_users %}
            <li>{{ user_name }} - {{ count }}íšŒ</li>
            {% endfor %}
        </ul>
        <h3>â˜ï¸ ì›Œë“œ í´ë¼ìš°ë“œ</h3>
        {% if wordcloud_url %}
            <img src="{{ wordcloud_url }}" alt="ì›Œë“œ í´ë¼ìš°ë“œ" style="width: 100%; max-width: 200px;">
        {% else %}
            <p>ë°ì´í„° ì—†ìŒ</p>
        {% endif %}
    </section>
    </div>
</div>
{% endblock %}